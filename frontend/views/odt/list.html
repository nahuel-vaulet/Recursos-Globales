<!-- ODT List View â€” loaded by SPA router as #/odt -->
<div style="padding: var(--spacing-md) 0;">
    <!-- Header -->
    <div
        style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:16px; margin-bottom:var(--spacing-lg);">
        <h1 style="font-size:var(--font-heading-1); display:flex; align-items:center; gap:10px;">
            <i class="fas fa-clipboard-list" style="color:var(--accent-primary);"></i>
            GestiÃ³n de ODTs
        </h1>
        <div style="display:flex; gap:8px;">
            <button class="btn btn-ghost" onclick="odtModule.exportCSV()"><i class="fas fa-file-csv"></i>
                Exportar</button>
            <button class="btn btn-primary" onclick="odtModule.reload()"><i class="fas fa-sync"></i> Actualizar</button>
        </div>
    </div>

    <!-- Metrics Bar -->
    <div class="kpi-grid" id="odtMetrics" style="margin-bottom:var(--spacing-lg);"></div>

    <!-- Filters -->
    <div class="card" style="margin-bottom:var(--spacing-md); padding:16px;">
        <div style="display:flex; flex-wrap:wrap; gap:12px; align-items:flex-end;">
            <div style="flex:1; min-width:200px;">
                <label class="filter-label">Buscar</label>
                <input type="text" id="odtSearch" placeholder="Nro ODT, direcciÃ³n, inspector..."
                    oninput="odtModule.debounceSearch()">
            </div>
            <div style="min-width:160px;">
                <label class="filter-label">Estado</label>
                <select id="odtEstado" onchange="odtModule.reload()">
                    <option value="">Todos</option>
                </select>
            </div>
            <div style="min-width:130px;">
                <label class="filter-label">Prioridad</label>
                <select id="odtPrioridad" onchange="odtModule.reload()">
                    <option value="">Todas</option>
                    <option value="1">ðŸ”´ Urgente</option>
                    <option value="2">ðŸŸ  Alta</option>
                    <option value="3">ðŸ”µ Normal</option>
                    <option value="4">ðŸŸ¢ Baja</option>
                    <option value="5">âšª MÃ­nima</option>
                </select>
            </div>
            <div style="min-width:130px;">
                <label class="filter-label">Cuadrilla</label>
                <select id="odtCuadrilla" onchange="odtModule.reload()">
                    <option value="">Todas</option>
                    <option value="SIN_ASIGNAR">Sin asignar</option>
                </select>
            </div>
            <div style="min-width:130px;">
                <label class="filter-label">Vencimiento</label>
                <select id="odtVencimiento" onchange="odtModule.reload()">
                    <option value="">Todo</option>
                    <option value="vencidas">Vencidas</option>
                    <option value="proximas">PrÃ³x. 7 dÃ­as</option>
                </select>
            </div>
            <button class="btn btn-ghost" onclick="odtModule.clearFilters()" style="height:42px;">
                <i class="fas fa-times"></i> Limpiar
            </button>
        </div>
    </div>

    <!-- Bulk Actions Bar -->
    <div id="odtBulkBar" class="card"
        style="display:none; padding:12px 16px; margin-bottom:12px; background:var(--bg-tertiary); border-left:4px solid var(--accent-primary);">
        <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap;">
            <span id="odtSelectedCount" style="font-weight:600;">0 seleccionadas</span>
            <select id="bulkEstado" style="width:auto; min-width:160px;">
                <option value="">Cambiar estado a...</option>
            </select>
            <button class="btn btn-primary" onclick="odtModule.applyBulk()" style="padding:8px 16px;">
                <i class="fas fa-check"></i> Aplicar
            </button>
            <button class="btn btn-ghost" onclick="odtModule.clearSelection()" style="padding:8px 16px;">
                Cancelar
            </button>
        </div>
    </div>

    <!-- Table -->
    <div class="card" style="padding:0; overflow-x:auto;">
        <table id="odtTable">
            <thead>
                <tr>
                    <th style="width:40px;"><input type="checkbox" id="odtSelectAll"
                            onchange="odtModule.toggleSelectAll(this.checked)"></th>
                    <th>Nro ODT</th>
                    <th>DirecciÃ³n</th>
                    <th>Tipo Trabajo</th>
                    <th>Estado</th>
                    <th>Prioridad</th>
                    <th>Cuadrilla</th>
                    <th>Fecha Asig.</th>
                    <th>Vencimiento</th>
                    <th style="width:100px;">Acciones</th>
                </tr>
            </thead>
            <tbody id="odtTableBody">
                <tr>
                    <td colspan="10" class="loading-spinner"><i class="fas fa-spinner fa-spin"></i> Cargando...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- ODT Detail Modal -->
<div id="odtDetailModal" class="modal-overlay" style="display:none;"
    onclick="if(event.target===this) this.style.display='none'">
    <div class="modal-content" style="max-width:700px;">
        <div class="modal-header">
            <h3 id="odtDetailTitle">Detalle ODT</h3>
            <button onclick="document.getElementById('odtDetailModal').style.display='none'"
                class="icon-btn">&times;</button>
        </div>
        <div id="odtDetailBody" style="padding:20px;"></div>
    </div>
</div>

<style>
    .filter-label {
        display: block;
        font-size: var(--font-micro);
        font-weight: 500;
        color: var(--text-muted);
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 3px 10px;
        border-radius: 20px;
        font-size: 0.78em;
        font-weight: 600;
        white-space: nowrap;
    }

    .priority-badge {
        display: inline-flex;
        align-items: center;
        gap: 3px;
        padding: 3px 8px;
        border-radius: 10px;
        font-size: 0.8em;
        font-weight: 600;
    }

    .crew-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        padding: 3px 10px;
        border-radius: 8px;
        font-size: 0.8em;
        font-weight: 500;
    }

    .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 4px 8px;
        color: var(--text-muted);
        transition: 0.15s;
        border-radius: 6px;
        font-size: 0.9em;
    }

    .action-btn:hover {
        background: rgba(255, 255, 255, 0.08);
        color: var(--accent-primary);
    }

    .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }

    .modal-content {
        background: var(--bg-card);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        width: 100%;
        border: 1px solid rgba(255, 255, 255, 0.06);
        max-height: 90vh;
        overflow-y: auto;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .kpi-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 12px;
    }

    .kpi-mini {
        background: var(--bg-card);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: var(--radius-sm);
        padding: 14px;
        text-align: center;
        cursor: pointer;
        transition: 0.15s;
    }

    .kpi-mini:hover {
        border-color: var(--accent-primary);
    }

    .kpi-mini.active {
        border-color: var(--accent-primary);
        background: rgba(100, 181, 246, 0.08);
    }

    .kpi-mini .kpi-val {
        font-size: 1.4rem;
        font-weight: 700;
        line-height: 1.2;
    }

    .kpi-mini .kpi-lbl {
        font-size: var(--font-micro);
        color: var(--text-muted);
        margin-top: 2px;
    }
</style>